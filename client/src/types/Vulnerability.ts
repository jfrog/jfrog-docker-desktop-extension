import { Severity } from './severity';

export type Vulnerability = {
  [VulnerabilityKeys.severity]: keyof Severity;
  [VulnerabilityKeys.impactedPackageName]: string;
  [VulnerabilityKeys.impactedPackageVersion]: string;
  [VulnerabilityKeys.impactedPackageType]: string;
  [VulnerabilityKeys.fixedVersions]?: string[];
  [VulnerabilityKeys.components]?: Component[];
  [VulnerabilityKeys.cves]?: string[];
  [VulnerabilityKeys.issueId]: string;
  [VulnerabilityKeys.summary]?: string;
  [VulnerabilityKeys.references]?: string[];
  [VulnerabilityKeys.impactPaths]?: Component[][];
  [VulnerabilityKeys.jfrogResearchInformation]?: JfrogResearchInformation;

  [VulnerabilityKeys.cveIds]?: string[];
  [VulnerabilityKeys.cvssV3]?: string[];
  [VulnerabilityKeys.cvssV2]?: string[];
};

type Component = {
  [component.name]: string;
  [component.version]: string;
};

type JfrogResearchInformation = {
  [JfrogResearchInformationKeys.summary]: string;
  [JfrogResearchInformationKeys.details]: string;
  [JfrogResearchInformationKeys.severity]: string;
  [JfrogResearchInformationKeys.severityReasons]: JfrogResearchSeverityReason;
  [JfrogResearchInformationKeys.remediation]?: string;
};

type JfrogResearchSeverityReason = {
  [JfrogResearchSeverityReasonKeys.name]: string;
  [JfrogResearchSeverityReasonKeys.description]: string;
  [JfrogResearchSeverityReasonKeys.isPositive]: boolean;
};

export enum VulnerabilityKeys {
  severity = 'severity',
  impactedPackageName = 'impactedPackageName',
  impactedPackageVersion = 'impactedPackageVersion',
  impactedPackageType = 'impactedPackageType',
  fixedVersions = 'fixedVersions',
  components = 'components',
  cves = 'cves',
  issueId = 'issueId',
  summary = 'summary',
  references = 'references',
  impactPaths = 'impactPaths',
  jfrogResearchInformation = 'jfrogResearchInformation',

  cveIds = 'cveIds',
  cvssV3 = 'cvssV3',
  cvssV2 = 'cvssV2',
}

enum JfrogResearchInformationKeys {
  summary = 'summary',
  details = 'details',
  severity = 'severity',
  severityReasons = 'severityReasons',
  remediation = 'remediation',
}

enum JfrogResearchSeverityReasonKeys {
  name = 'name',
  description = 'description',
  isPositive = 'isPositive',
}

enum component {
  name = 'name',
  version = 'version',
}
